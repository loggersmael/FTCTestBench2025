var Z=t=>{throw TypeError(t)};var te=(t,e,s)=>e.has(t)||Z("Cannot "+s);var i=(t,e,s)=>(te(t,e,"read from private field"),s?s.call(t):e.get(t)),r=(t,e,s)=>e.has(t)?Z("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s);import{X as c,g as a,Y as g,d as I}from"./CprfUR79.js";import{p as l}from"./CDl5DGgc.js";import{n as _,i as se}from"./wsybdplX.js";const u=[];for(let t=0;t<256;++t)u.push((t+256).toString(16).slice(1));function ie(t,e=0){return(u[t[e+0]]+u[t[e+1]]+u[t[e+2]]+u[t[e+3]]+"-"+u[t[e+4]]+u[t[e+5]]+"-"+u[t[e+6]]+u[t[e+7]]+"-"+u[t[e+8]]+u[t[e+9]]+"-"+u[t[e+10]]+u[t[e+11]]+u[t[e+12]]+u[t[e+13]]+u[t[e+14]]+u[t[e+15]]).toLowerCase()}let j;const ne=new Uint8Array(16);function re(){if(!j){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");j=crypto.getRandomValues.bind(crypto)}return j(ne)}const ae=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ee={randomUUID:ae};function f(t,e,s){var o;if(ee.randomUUID&&!t)return ee.randomUUID();t=t||{};const d=t.random??((o=t.rng)==null?void 0:o.call(t))??re();if(d.length<16)throw new Error("Random bytes length must be >= 16");return d[6]=d[6]&15|64,d[8]=d[8]&63|128,ie(d)}const pe=["Custom","OpMode Control","Gamepad","Field","Telemetry","Configurables","Graph","Capture","LL Dash","LL Feed","Test"];var le=(t=>(t.CONTROLS="OpMode Control",t.GAMEPAD="Gamepad",t.FIELD="Field",t.TELEMETRY="Telemetry",t.CONFIGURABLES="Configurables",t.GRAPH="Graph",t.CAPTURE="Capture",t.LIMELIGHT_DASH="LL Dash",t.LIMELIGHT_FEED="LL Feed",t.CUSTOM="Custom",t.TEST="Test",t))(le||{});function de(){return{id:f(),name:"Default",x:10,y:10,modules:[{id:f(),pluginID:"none",pageID:"none",type:"OpMode Control",start:{x:1,y:1},sizes:{x:3,y:2}},{id:f(),pluginID:"none",pageID:"none",type:"Capture",start:{x:1,y:3},sizes:{x:3,y:4}},{id:f(),pluginID:"none",pageID:"none",type:"Gamepad",start:{x:1,y:7},sizes:{x:3,y:4}},{id:f(),pluginID:"none",pageID:"none",type:"Field",start:{x:4,y:1},sizes:{x:3,y:4}},{id:f(),pluginID:"none",pageID:"none",type:"Telemetry",start:{x:4,y:5},sizes:{x:3,y:2}},{id:f(),pluginID:"none",pageID:"none",type:"Graph",start:{x:4,y:7},sizes:{x:3,y:4}},{id:f(),pluginID:"none",pageID:"none",type:"Configurables",start:{x:7,y:1},sizes:{x:4,y:6}},{id:f(),pluginID:"none",pageID:"none",type:"LL Feed",start:{x:7,y:7},sizes:{x:4,y:2}},{id:f(),pluginID:"none",pageID:"none",type:"LL Dash",start:{x:7,y:9},sizes:{x:4,y:2}}]}}var C,L,E,k,G,S,v,w,A,T,b,$,W;const q=class q{constructor(e){r(this,C,c(8));r(this,L,c(6));r(this,E,c("Default"));r(this,k,c(""));r(this,G,c(!1));r(this,S,c(-1));r(this,v,c(-1));r(this,w,c(""));r(this,A,I(()=>this.getWidgetById(this.selectedWidgetId)));r(this,T,I(()=>this.checkPlace(this.selectedWidget)));r(this,b,c(l([])));r(this,$,I(()=>this.updateMap(this.modules)));r(this,W,I(()=>{var e=0;for(const s of this.modules)e+=s.sizes.x*s.sizes.y;return e}));e==null&&(e=de()),this.id=e.id,this.name=e.name,this.cellsX=e.x,this.cellsY=e.y,this.modules=e.modules}get cellsX(){return a(i(this,C))}set cellsX(e){g(i(this,C),l(e))}get cellsY(){return a(i(this,L))}set cellsY(e){g(i(this,L),l(e))}get name(){return a(i(this,E))}set name(e){g(i(this,E),l(e))}get id(){return a(i(this,k))}set id(e){g(i(this,k),l(e))}get isMoving(){return a(i(this,G))}set isMoving(e){g(i(this,G),l(e))}get selectedCellX(){return a(i(this,S))}set selectedCellX(e){g(i(this,S),l(e))}get selectedCellY(){return a(i(this,v))}set selectedCellY(e){g(i(this,v),l(e))}get selectedWidgetId(){return a(i(this,w))}set selectedWidgetId(e){g(i(this,w),l(e))}get selectedWidget(){return a(i(this,A))}get canPlace(){return a(i(this,T))}checkIndex(e){return this.coreCheckPlace(e%this.cellsX+1,Math.floor(e/this.cellsX)+1,this.selectedWidget)}coreCheckPlace(e,s,d){if(d==null)return!1;for(let o=0;o<d.sizes.x;o++)for(let n=0;n<d.sizes.y;n++){const h=e+o,p=s+n;if(h>this.cellsX||p>this.cellsY||h<1||p<1||this.modulesMap[p][h]!=null&&this.modulesMap[p][h]!=d.id)return!1}return!0}checkPlace(e){return this.coreCheckPlace(this.selectedCellX,this.selectedCellY,e)}getWidgetById(e){for(const s of this.modules)if(s.id==e)return s;return null}get modules(){return a(i(this,b))}set modules(e){g(i(this,b),l(e))}get modulesMap(){return a(i(this,$))}updateMap(e){let s=0,d=0;for(const n of e)s=Math.max(s,n.start.x+n.sizes.x),d=Math.max(d,n.start.y+n.sizes.y);const o=[];for(let n=1;n<this.cellsY+1;n++){o[n]=[];for(let h=1;h<this.cellsX+1;h++)o[n][h]=null}for(const n of e)for(let h=0;h<n.sizes.x;h++)for(let p=0;p<n.sizes.y;p++){const N=n.start.x+h,F=n.start.y+p;o[F][N]=n.id}return console.table(o),o}get countCells(){return a(i(this,W))}startMoving(e){this.isMoving=!0,this.selectedWidgetId=e;for(const s of this.modules)s.id==e&&(this.selectedCellX=s.start.x-1,this.selectedCellY=s.start.y-1)}stopMoving(e){e!=""&&e!=null&&_.add(e),this.isMoving=!1,this.selectedWidgetId=""}performMove(){if(this.selectedWidget!=null)for(const e of this.modules)e.id==this.selectedWidgetId&&(e.start.x=this.selectedCellX,e.start.y=this.selectedCellY)}canExpand(e,s,d){var N,F,K,Q;const{x:o,y:n}=e.start,{x:h,y:p}=e.sizes;if(s===1)for(let m=0;m<p;m++){const x=n+m,y=o+h;if(y>this.cellsX||((N=this.modulesMap[x])==null?void 0:N[y])!==null)return!1}else if(s===-1)for(let m=0;m<p;m++){const x=n+m,y=o-1;if(y<1||((F=this.modulesMap[x])==null?void 0:F[y])!==null)return!1}else if(d===1)for(let m=0;m<h;m++){const x=o+m,y=n+p;if(y>this.cellsY||((K=this.modulesMap[y])==null?void 0:K[x])!==null)return!1}else if(d===-1)for(let m=0;m<h;m++){const x=o+m,y=n-1;if(y<1||((Q=this.modulesMap[y])==null?void 0:Q[x])!==null)return!1}return!0}remove(e){this.modules=this.modules.filter(s=>s.id!=e)}addNew(e,s){if(this.modulesMap[s][e]!=null){_.add("Slot is already in use.");return}this.modules.push({id:f(),pluginID:"none",pageID:"none",type:"Test",start:{x:e,y:s},sizes:{x:1,y:1}})}canExpandRight(e){return this.canExpand(e,1,0)}canExpandLeft(e){return this.canExpand(e,-1,0)}canExpandDown(e){return this.canExpand(e,0,1)}canExpandUp(e){return this.canExpand(e,0,-1)}static fromJSON(e){return new q(e)}toJSON(){return{id:this.id,name:this.name,x:this.cellsX,y:this.cellsY,modules:this.modules}}};C=new WeakMap,L=new WeakMap,E=new WeakMap,k=new WeakMap,G=new WeakMap,S=new WeakMap,v=new WeakMap,w=new WeakMap,A=new WeakMap,T=new WeakMap,b=new WeakMap,$=new WeakMap,W=new WeakMap;let D=q;function J(t,e,s=31536e3){document.cookie=`${t}=${e}; path=/; max-age=${s}`}function M(t){const e=document.cookie.match(new RegExp(`(?:^|; )${t.replace(/([.$?*|{}()[]\/+^])/g,"\\$1")}=([^;]*)`));return e?decodeURIComponent(e[1]):null}function oe(t){document.cookie=`${t}=; path=/; max-age=0`}var z,O,P,X,Y,U,R,B,H,V;class ue{constructor(){r(this,z,c(M("theme")==="dark"));r(this,O,c(l(M("animations")||"fast")));r(this,P,c(l(M("primary")||"blue")));r(this,X,c(l(!!M("presets"))));r(this,Y,c("default"));r(this,U,c(l(this.getInitialGrids())));r(this,R,c(l(this.getInitialGrids())));r(this,B,I(()=>JSON.stringify(this.initialGrids)!=JSON.stringify(this.gridManagers)));r(this,H,I(()=>{const e=this.getGridById(this.selectedManagerID);return e??(this.selectedManagerID=this.gridManagers[0].id,this.gridManagers[0])}));r(this,V,I(()=>this.gridManagers.map(e=>e.id)));document.body.classList.toggle("dark-mode",this.isDark),document.body.classList.add(this.animationSpeed)}get isDark(){return a(i(this,z))}set isDark(e){g(i(this,z),l(e))}get animationSpeed(){return a(i(this,O))}set animationSpeed(e){g(i(this,O),l(e))}get primaryColor(){return a(i(this,P))}set primaryColor(e){g(i(this,P),l(e))}toggleIsDark(){this.isDark=!this.isDark,document.body.classList.toggle("dark-mode",this.isDark),J("theme",this.isDark?"dark":"light")}setSpeed(e){document.body.classList.remove(this.animationSpeed),this.animationSpeed=e,document.body.classList.add(this.animationSpeed),J("animations",e)}setPrimaryColor(e){document.body.classList.remove(this.primaryColor),this.primaryColor=e,document.body.classList.add(this.primaryColor),J("primary",this.primaryColor)}getInitialGrids(){const e=M("presets"),s=e?JSON.parse(e):[null],d=[];for(const[o,n]of Object.entries(s))d.push(D.fromJSON(n));return d.length<1?[new D(null)]:d}resetPresets(){this.selectedManagerID="default",oe("presets"),this.gridManagers=[new D(null)],this.initialGrids=[new D(null)],this.hasPresets=!1,se.showEdit=!1}removePreset(e){if(this.gridManagers.length==1){_.add("Cannot remove last preset.");return}this.gridManagers=this.gridManagers.filter(s=>s.id!=e)}get hasPresets(){return a(i(this,X))}set hasPresets(e){g(i(this,X),l(e))}get selectedManagerID(){return a(i(this,Y))}set selectedManagerID(e){g(i(this,Y),l(e))}get initialGrids(){return a(i(this,U))}set initialGrids(e){g(i(this,U),l(e))}get gridManagers(){return a(i(this,R))}set gridManagers(e){g(i(this,R),l(e))}get isGridEdited(){return a(i(this,B))}getGridById(e){for(const s of this.gridManagers)if(s.id==e)return s;return null}get currentGrid(){return a(i(this,H))}savePresets(){const e=this.gridManagers.map(s=>s.toJSON());J("presets",JSON.stringify(e)),this.hasPresets=!0,this.initialGrids=this.gridManagers}get allIDs(){return a(i(this,V))}}z=new WeakMap,O=new WeakMap,P=new WeakMap,X=new WeakMap,Y=new WeakMap,U=new WeakMap,R=new WeakMap,B=new WeakMap,H=new WeakMap,V=new WeakMap;const ye=new ue;export{D as G,le as W,pe as a,de as d,ye as s};
