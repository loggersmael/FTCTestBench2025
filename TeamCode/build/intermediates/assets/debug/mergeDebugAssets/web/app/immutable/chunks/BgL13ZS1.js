var te=t=>{throw TypeError(t)};var ie=(t,e,i)=>e.has(t)||te("Cannot "+i);var s=(t,e,i)=>(ie(t,e,"read from private field"),i?i.call(t):e.get(t)),r=(t,e,i)=>e.has(t)?te("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,i);import{a9 as h,g as l,G as u,d as M}from"./0-szhb9U.js";import{p as a}from"./BzflOjYQ.js";import{n as Q,i as ne}from"./BhkLYMz6.js";const c=[];for(let t=0;t<256;++t)c.push((t+256).toString(16).slice(1));function re(t,e=0){return(c[t[e+0]]+c[t[e+1]]+c[t[e+2]]+c[t[e+3]]+"-"+c[t[e+4]]+c[t[e+5]]+"-"+c[t[e+6]]+c[t[e+7]]+"-"+c[t[e+8]]+c[t[e+9]]+"-"+c[t[e+10]]+c[t[e+11]]+c[t[e+12]]+c[t[e+13]]+c[t[e+14]]+c[t[e+15]]).toLowerCase()}let K;const ae=new Uint8Array(16);function le(){if(!K){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");K=crypto.getRandomValues.bind(crypto)}return K(ae)}const oe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),se={randomUUID:oe};function y(t,e,i){var d;if(se.randomUUID&&!t)return se.randomUUID();t=t||{};const o=t.random??((d=t.rng)==null?void 0:d.call(t))??le();if(o.length<16)throw new Error("Random bytes length must be >= 16");return o[6]=o[6]&15|64,o[8]=o[8]&63|128,re(o)}const ye=["Custom","OpMode Control","Gamepad","Field","Telemetry","Configurables","Graph","Capture","Test"];var de=(t=>(t.CONTROLS="OpMode Control",t.GAMEPAD="Gamepad",t.FIELD="Field",t.TELEMETRY="Telemetry",t.CONFIGURABLES="Configurables",t.GRAPH="Graph",t.CAPTURE="Capture",t.CUSTOM="Custom",t.TEST="Test",t))(de||{});function he(){return{id:y(),name:"Default",x:10,y:10,modules:[{id:y(),activeType:0,types:[{type:"OpMode Control",pluginID:"none",pageID:"none"}],start:{x:1,y:1},sizes:{x:3,y:2}},{id:y(),activeType:0,types:[{type:"Capture",pluginID:"none",pageID:"none"}],start:{x:4,y:1},sizes:{x:3,y:4}},{id:y(),activeType:0,types:[{type:"Gamepad",pluginID:"none",pageID:"none"}],start:{x:1,y:3},sizes:{x:3,y:2}},{id:y(),activeType:0,types:[{type:"Field",pluginID:"none",pageID:"none"}],start:{x:1,y:5},sizes:{x:3,y:6}},{id:y(),activeType:0,types:[{type:"Telemetry",pluginID:"none",pageID:"none"},{type:"Graph",pluginID:"none",pageID:"none"}],start:{x:4,y:5},sizes:{x:3,y:6}},{id:y(),activeType:0,types:[{type:"Configurables",pluginID:"none",pageID:"none"}],start:{x:7,y:1},sizes:{x:4,y:10}}]}}var S,v,k,w,O,G,E,b,$,A,P,B,V;const Z=class Z{constructor(e){r(this,S,h(8));r(this,v,h(6));r(this,k,h("Default"));r(this,w,h(""));r(this,O,h(!1));r(this,G,h(-1));r(this,E,h(-1));r(this,b,h(""));r(this,$,M(()=>this.getWidgetById(this.selectedWidgetId)));r(this,A,M(()=>this.checkPlace(this.selectedWidget)));r(this,P,h(a([])));r(this,B,M(()=>this.updateMap(this.modules)));r(this,V,M(()=>{var e=0;for(const i of this.modules)e+=i.sizes.x*i.sizes.y;return e}));e==null&&(e=he()),this.id=e.id,this.name=e.name,this.cellsX=e.x,this.cellsY=e.y,this.modules=e.modules}get cellsX(){return l(s(this,S))}set cellsX(e){u(s(this,S),a(e))}get cellsY(){return l(s(this,v))}set cellsY(e){u(s(this,v),a(e))}get name(){return l(s(this,k))}set name(e){u(s(this,k),a(e))}get id(){return l(s(this,w))}set id(e){u(s(this,w),a(e))}get isMoving(){return l(s(this,O))}set isMoving(e){u(s(this,O),a(e))}get selectedCellX(){return l(s(this,G))}set selectedCellX(e){u(s(this,G),a(e))}get selectedCellY(){return l(s(this,E))}set selectedCellY(e){u(s(this,E),a(e))}get selectedWidgetId(){return l(s(this,b))}set selectedWidgetId(e){u(s(this,b),a(e))}get selectedWidget(){return l(s(this,$))}get canPlace(){return l(s(this,A))}checkIndex(e){return this.coreCheckPlace(e%this.cellsX+1,Math.floor(e/this.cellsX)+1,this.selectedWidget)}coreCheckPlace(e,i,o){if(o==null)return!1;for(let d=0;d<o.sizes.x;d++)for(let n=0;n<o.sizes.y;n++){const g=e+d,p=i+n;if(g>this.cellsX||p>this.cellsY||g<1||p<1||this.modulesMap[p][g]!=null&&this.modulesMap[p][g]!=o.id)return!1}return!0}checkPlace(e){return this.coreCheckPlace(this.selectedCellX,this.selectedCellY,e)}getWidgetById(e){for(const i of this.modules)if(i.id==e)return i;return null}get modules(){return l(s(this,P))}set modules(e){u(s(this,P),a(e))}get modulesMap(){return l(s(this,B))}updateMap(e){let i=0,o=0;for(const n of e)i=Math.max(i,n.start.x+n.sizes.x),o=Math.max(o,n.start.y+n.sizes.y);const d=[];for(let n=1;n<this.cellsY+1;n++){d[n]=[];for(let g=1;g<this.cellsX+1;g++)d[n][g]=null}for(const n of e)for(let g=0;g<n.sizes.x;g++)for(let p=0;p<n.sizes.y;p++){const W=n.start.x+g,F=n.start.y+p;d[F][W]=n.id}return console.table(d),d}get countCells(){return l(s(this,V))}startMoving(e){this.isMoving=!0,this.selectedWidgetId=e;for(const i of this.modules)i.id==e&&(this.selectedCellX=i.start.x-1,this.selectedCellY=i.start.y-1)}stopMoving(e){e!=""&&e!=null&&Q.add(e),this.isMoving=!1,this.selectedWidgetId=""}performMove(){if(this.selectedWidget!=null)for(const e of this.modules)e.id==this.selectedWidgetId&&(e.start.x=this.selectedCellX,e.start.y=this.selectedCellY)}canExpand(e,i,o){var W,F,_,ee;const{x:d,y:n}=e.start,{x:g,y:p}=e.sizes;if(i===1)for(let m=0;m<p;m++){const x=n+m,f=d+g;if(f>this.cellsX||((W=this.modulesMap[x])==null?void 0:W[f])!==null)return!1}else if(i===-1)for(let m=0;m<p;m++){const x=n+m,f=d-1;if(f<1||((F=this.modulesMap[x])==null?void 0:F[f])!==null)return!1}else if(o===1)for(let m=0;m<g;m++){const x=d+m,f=n+p;if(f>this.cellsY||((_=this.modulesMap[f])==null?void 0:_[x])!==null)return!1}else if(o===-1)for(let m=0;m<g;m++){const x=d+m,f=n-1;if(f<1||((ee=this.modulesMap[f])==null?void 0:ee[x])!==null)return!1}return!0}remove(e){this.modules=this.modules.filter(i=>i.id!=e)}addNew(e,i){if(this.modulesMap[i][e]!=null){Q.add("Slot is already in use.");return}this.modules.push({id:y(),activeType:0,types:[{type:"Test",pluginID:"none",pageID:"none"}],start:{x:e,y:i},sizes:{x:1,y:1}})}canExpandRight(e){return this.canExpand(e,1,0)}canExpandLeft(e){return this.canExpand(e,-1,0)}canExpandDown(e){return this.canExpand(e,0,1)}canExpandUp(e){return this.canExpand(e,0,-1)}static fromJSON(e){return new Z(e)}toJSON(){return{id:this.id,name:this.name,x:this.cellsX,y:this.cellsY,modules:this.modules}}};S=new WeakMap,v=new WeakMap,k=new WeakMap,w=new WeakMap,O=new WeakMap,G=new WeakMap,E=new WeakMap,b=new WeakMap,$=new WeakMap,A=new WeakMap,P=new WeakMap,B=new WeakMap,V=new WeakMap;let D=Z;function I(t,e,i=31536e3){document.cookie=`${t}=${e}; path=/; max-age=${i}`}function C(t){const e=document.cookie.match(new RegExp(`(?:^|; )${t.replace(/([.$?*|{}()[]\/+^])/g,"\\$1")}=([^;]*)`));return e?decodeURIComponent(e[1]):null}function ue(t){document.cookie=`${t}=; path=/; max-age=0`}var X,z,Y,U,T,L,R,N,J,j,H,q;class ce{constructor(){r(this,X,h(C("theme")==="dark"));r(this,z,h(a(C("animations")||"fast")));r(this,Y,h(a(C("primary")||"blue")));r(this,U,h(a(C("fieldOrientation")||"0deg")));r(this,T,h(a(C("fieldShowCoordinates")||"false")));r(this,L,h(a(!!C("presets"))));r(this,R,h("default"));r(this,N,h(a(this.getInitialGrids())));r(this,J,h(a(this.getInitialGrids())));r(this,j,M(()=>JSON.stringify(this.initialGrids)!=JSON.stringify(this.gridManagers)));r(this,H,M(()=>{const e=this.getGridById(this.selectedManagerID);return e??(this.selectedManagerID=this.gridManagers[0].id,this.gridManagers[0])}));r(this,q,M(()=>this.gridManagers.map(e=>e.id)));document.body.classList.toggle("dark-mode",this.isDark),document.body.classList.add(this.animationSpeed)}get isDark(){return l(s(this,X))}set isDark(e){u(s(this,X),a(e))}get animationSpeed(){return l(s(this,z))}set animationSpeed(e){u(s(this,z),a(e))}get primaryColor(){return l(s(this,Y))}set primaryColor(e){u(s(this,Y),a(e))}get fieldOrientation(){return l(s(this,U))}set fieldOrientation(e){u(s(this,U),a(e))}get fieldShowCoordinates(){return l(s(this,T))}set fieldShowCoordinates(e){u(s(this,T),a(e))}toggleIsDark(){this.isDark=!this.isDark,document.body.classList.toggle("dark-mode",this.isDark),I("theme",this.isDark?"dark":"light")}setSpeed(e){document.body.classList.remove(this.animationSpeed),this.animationSpeed=e,document.body.classList.add(this.animationSpeed),I("animations",e)}setPrimaryColor(e){document.body.classList.remove(this.primaryColor),this.primaryColor=e,document.body.classList.add(this.primaryColor),I("primary",this.primaryColor)}setFieldOrientation(e){this.fieldOrientation=e,I("fieldOrientation",e)}setFieldShowCoordinates(e){this.fieldShowCoordinates=e,I("fieldShowCoordinates",e)}getInitialGrids(){const e=C("presets"),i=e?JSON.parse(e):[null],o=[];for(const[d,n]of Object.entries(i))o.push(D.fromJSON(n));return o.length<1?[new D(null)]:o}resetPresets(){this.selectedManagerID="default",ue("presets"),this.gridManagers=[new D(null)],this.initialGrids=[new D(null)],this.hasPresets=!1,ne.showEdit=!1}removePreset(e){if(this.gridManagers.length==1){Q.add("Cannot remove last preset.");return}this.gridManagers=this.gridManagers.filter(i=>i.id!=e)}get hasPresets(){return l(s(this,L))}set hasPresets(e){u(s(this,L),a(e))}get selectedManagerID(){return l(s(this,R))}set selectedManagerID(e){u(s(this,R),a(e))}get initialGrids(){return l(s(this,N))}set initialGrids(e){u(s(this,N),a(e))}get gridManagers(){return l(s(this,J))}set gridManagers(e){u(s(this,J),a(e))}get isGridEdited(){return l(s(this,j))}getGridById(e){for(const i of this.gridManagers)if(i.id==e)return i;return null}get currentGrid(){return l(s(this,H))}savePresets(){const e=this.gridManagers.map(i=>i.toJSON());I("presets",JSON.stringify(e)),this.hasPresets=!0,this.initialGrids=this.gridManagers}get allIDs(){return l(s(this,q))}}X=new WeakMap,z=new WeakMap,Y=new WeakMap,U=new WeakMap,T=new WeakMap,L=new WeakMap,R=new WeakMap,N=new WeakMap,J=new WeakMap,j=new WeakMap,H=new WeakMap,q=new WeakMap;const xe=new ce;export{D as G,de as W,ye as a,he as d,xe as s,y as v};
