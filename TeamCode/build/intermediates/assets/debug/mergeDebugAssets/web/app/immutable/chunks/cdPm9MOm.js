var _=t=>{throw TypeError(t)};var te=(t,e,s)=>e.has(t)||_("Cannot "+s);var i=(t,e,s)=>(te(t,e,"read from private field"),s?s.call(t):e.get(t)),r=(t,e,s)=>e.has(t)?_("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s);import{a9 as h,g as a,G as g,d as M}from"./0-szhb9U.js";import{p as l}from"./BzflOjYQ.js";import{n as q,i as se}from"./DE8FGzRE.js";const u=[];for(let t=0;t<256;++t)u.push((t+256).toString(16).slice(1));function ie(t,e=0){return(u[t[e+0]]+u[t[e+1]]+u[t[e+2]]+u[t[e+3]]+"-"+u[t[e+4]]+u[t[e+5]]+"-"+u[t[e+6]]+u[t[e+7]]+"-"+u[t[e+8]]+u[t[e+9]]+"-"+u[t[e+10]]+u[t[e+11]]+u[t[e+12]]+u[t[e+13]]+u[t[e+14]]+u[t[e+15]]).toLowerCase()}let H;const ne=new Uint8Array(16);function re(){if(!H){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");H=crypto.getRandomValues.bind(crypto)}return H(ne)}const ae=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ee={randomUUID:ae};function f(t,e,s){var o;if(ee.randomUUID&&!t)return ee.randomUUID();t=t||{};const d=t.random??((o=t.rng)==null?void 0:o.call(t))??re();if(d.length<16)throw new Error("Random bytes length must be >= 16");return d[6]=d[6]&15|64,d[8]=d[8]&63|128,ie(d)}const pe=["Custom","OpMode Control","Gamepad","Field","Telemetry","Configurables","Graph","Capture","Test"];var le=(t=>(t.CONTROLS="OpMode Control",t.GAMEPAD="Gamepad",t.FIELD="Field",t.TELEMETRY="Telemetry",t.CONFIGURABLES="Configurables",t.GRAPH="Graph",t.CAPTURE="Capture",t.CUSTOM="Custom",t.TEST="Test",t))(le||{});function de(){return{id:f(),name:"Default",x:10,y:10,modules:[{id:f(),activeType:0,types:[{type:"OpMode Control",pluginID:"none",pageID:"none"}],start:{x:1,y:1},sizes:{x:3,y:2}},{id:f(),activeType:0,types:[{type:"Capture",pluginID:"none",pageID:"none"}],start:{x:4,y:1},sizes:{x:3,y:4}},{id:f(),activeType:0,types:[{type:"Gamepad",pluginID:"none",pageID:"none"}],start:{x:1,y:3},sizes:{x:3,y:2}},{id:f(),activeType:0,types:[{type:"Field",pluginID:"none",pageID:"none"}],start:{x:1,y:5},sizes:{x:3,y:6}},{id:f(),activeType:0,types:[{type:"Telemetry",pluginID:"none",pageID:"none"},{type:"Graph",pluginID:"none",pageID:"none"}],start:{x:4,y:5},sizes:{x:3,y:6}},{id:f(),activeType:0,types:[{type:"Configurables",pluginID:"none",pageID:"none"}],start:{x:7,y:1},sizes:{x:4,y:10}}]}}var D,v,k,G,S,E,w,b,W,$,O,A,B;const K=class K{constructor(e){r(this,D,h(8));r(this,v,h(6));r(this,k,h("Default"));r(this,G,h(""));r(this,S,h(!1));r(this,E,h(-1));r(this,w,h(-1));r(this,b,h(""));r(this,W,M(()=>this.getWidgetById(this.selectedWidgetId)));r(this,$,M(()=>this.checkPlace(this.selectedWidget)));r(this,O,h(l([])));r(this,A,M(()=>this.updateMap(this.modules)));r(this,B,M(()=>{var e=0;for(const s of this.modules)e+=s.sizes.x*s.sizes.y;return e}));e==null&&(e=de()),this.id=e.id,this.name=e.name,this.cellsX=e.x,this.cellsY=e.y,this.modules=e.modules}get cellsX(){return a(i(this,D))}set cellsX(e){g(i(this,D),l(e))}get cellsY(){return a(i(this,v))}set cellsY(e){g(i(this,v),l(e))}get name(){return a(i(this,k))}set name(e){g(i(this,k),l(e))}get id(){return a(i(this,G))}set id(e){g(i(this,G),l(e))}get isMoving(){return a(i(this,S))}set isMoving(e){g(i(this,S),l(e))}get selectedCellX(){return a(i(this,E))}set selectedCellX(e){g(i(this,E),l(e))}get selectedCellY(){return a(i(this,w))}set selectedCellY(e){g(i(this,w),l(e))}get selectedWidgetId(){return a(i(this,b))}set selectedWidgetId(e){g(i(this,b),l(e))}get selectedWidget(){return a(i(this,W))}get canPlace(){return a(i(this,$))}checkIndex(e){return this.coreCheckPlace(e%this.cellsX+1,Math.floor(e/this.cellsX)+1,this.selectedWidget)}coreCheckPlace(e,s,d){if(d==null)return!1;for(let o=0;o<d.sizes.x;o++)for(let n=0;n<d.sizes.y;n++){const c=e+o,p=s+n;if(c>this.cellsX||p>this.cellsY||c<1||p<1||this.modulesMap[p][c]!=null&&this.modulesMap[p][c]!=d.id)return!1}return!0}checkPlace(e){return this.coreCheckPlace(this.selectedCellX,this.selectedCellY,e)}getWidgetById(e){for(const s of this.modules)if(s.id==e)return s;return null}get modules(){return a(i(this,O))}set modules(e){g(i(this,O),l(e))}get modulesMap(){return a(i(this,A))}updateMap(e){let s=0,d=0;for(const n of e)s=Math.max(s,n.start.x+n.sizes.x),d=Math.max(d,n.start.y+n.sizes.y);const o=[];for(let n=1;n<this.cellsY+1;n++){o[n]=[];for(let c=1;c<this.cellsX+1;c++)o[n][c]=null}for(const n of e)for(let c=0;c<n.sizes.x;c++)for(let p=0;p<n.sizes.y;p++){const R=n.start.x+c,N=n.start.y+p;o[N][R]=n.id}return console.table(o),o}get countCells(){return a(i(this,B))}startMoving(e){this.isMoving=!0,this.selectedWidgetId=e;for(const s of this.modules)s.id==e&&(this.selectedCellX=s.start.x-1,this.selectedCellY=s.start.y-1)}stopMoving(e){e!=""&&e!=null&&q.add(e),this.isMoving=!1,this.selectedWidgetId=""}performMove(){if(this.selectedWidget!=null)for(const e of this.modules)e.id==this.selectedWidgetId&&(e.start.x=this.selectedCellX,e.start.y=this.selectedCellY)}canExpand(e,s,d){var R,N,Q,Z;const{x:o,y:n}=e.start,{x:c,y:p}=e.sizes;if(s===1)for(let m=0;m<p;m++){const x=n+m,y=o+c;if(y>this.cellsX||((R=this.modulesMap[x])==null?void 0:R[y])!==null)return!1}else if(s===-1)for(let m=0;m<p;m++){const x=n+m,y=o-1;if(y<1||((N=this.modulesMap[x])==null?void 0:N[y])!==null)return!1}else if(d===1)for(let m=0;m<c;m++){const x=o+m,y=n+p;if(y>this.cellsY||((Q=this.modulesMap[y])==null?void 0:Q[x])!==null)return!1}else if(d===-1)for(let m=0;m<c;m++){const x=o+m,y=n-1;if(y<1||((Z=this.modulesMap[y])==null?void 0:Z[x])!==null)return!1}return!0}remove(e){this.modules=this.modules.filter(s=>s.id!=e)}addNew(e,s){if(this.modulesMap[s][e]!=null){q.add("Slot is already in use.");return}this.modules.push({id:f(),activeType:0,types:[{type:"Test",pluginID:"none",pageID:"none"}],start:{x:e,y:s},sizes:{x:1,y:1}})}canExpandRight(e){return this.canExpand(e,1,0)}canExpandLeft(e){return this.canExpand(e,-1,0)}canExpandDown(e){return this.canExpand(e,0,1)}canExpandUp(e){return this.canExpand(e,0,-1)}static fromJSON(e){return new K(e)}toJSON(){return{id:this.id,name:this.name,x:this.cellsX,y:this.cellsY,modules:this.modules}}};D=new WeakMap,v=new WeakMap,k=new WeakMap,G=new WeakMap,S=new WeakMap,E=new WeakMap,w=new WeakMap,b=new WeakMap,W=new WeakMap,$=new WeakMap,O=new WeakMap,A=new WeakMap,B=new WeakMap;let I=K;function J(t,e,s=31536e3){document.cookie=`${t}=${e}; path=/; max-age=${s}`}function C(t){const e=document.cookie.match(new RegExp(`(?:^|; )${t.replace(/([.$?*|{}()[]\/+^])/g,"\\$1")}=([^;]*)`));return e?decodeURIComponent(e[1]):null}function oe(t){document.cookie=`${t}=; path=/; max-age=0`}var P,X,z,Y,U,T,L,F,V,j;class ue{constructor(){r(this,P,h(C("theme")==="dark"));r(this,X,h(l(C("animations")||"fast")));r(this,z,h(l(C("primary")||"blue")));r(this,Y,h(l(!!C("presets"))));r(this,U,h("default"));r(this,T,h(l(this.getInitialGrids())));r(this,L,h(l(this.getInitialGrids())));r(this,F,M(()=>JSON.stringify(this.initialGrids)!=JSON.stringify(this.gridManagers)));r(this,V,M(()=>{const e=this.getGridById(this.selectedManagerID);return e??(this.selectedManagerID=this.gridManagers[0].id,this.gridManagers[0])}));r(this,j,M(()=>this.gridManagers.map(e=>e.id)));document.body.classList.toggle("dark-mode",this.isDark),document.body.classList.add(this.animationSpeed)}get isDark(){return a(i(this,P))}set isDark(e){g(i(this,P),l(e))}get animationSpeed(){return a(i(this,X))}set animationSpeed(e){g(i(this,X),l(e))}get primaryColor(){return a(i(this,z))}set primaryColor(e){g(i(this,z),l(e))}toggleIsDark(){this.isDark=!this.isDark,document.body.classList.toggle("dark-mode",this.isDark),J("theme",this.isDark?"dark":"light")}setSpeed(e){document.body.classList.remove(this.animationSpeed),this.animationSpeed=e,document.body.classList.add(this.animationSpeed),J("animations",e)}setPrimaryColor(e){document.body.classList.remove(this.primaryColor),this.primaryColor=e,document.body.classList.add(this.primaryColor),J("primary",this.primaryColor)}getInitialGrids(){const e=C("presets"),s=e?JSON.parse(e):[null],d=[];for(const[o,n]of Object.entries(s))d.push(I.fromJSON(n));return d.length<1?[new I(null)]:d}resetPresets(){this.selectedManagerID="default",oe("presets"),this.gridManagers=[new I(null)],this.initialGrids=[new I(null)],this.hasPresets=!1,se.showEdit=!1}removePreset(e){if(this.gridManagers.length==1){q.add("Cannot remove last preset.");return}this.gridManagers=this.gridManagers.filter(s=>s.id!=e)}get hasPresets(){return a(i(this,Y))}set hasPresets(e){g(i(this,Y),l(e))}get selectedManagerID(){return a(i(this,U))}set selectedManagerID(e){g(i(this,U),l(e))}get initialGrids(){return a(i(this,T))}set initialGrids(e){g(i(this,T),l(e))}get gridManagers(){return a(i(this,L))}set gridManagers(e){g(i(this,L),l(e))}get isGridEdited(){return a(i(this,F))}getGridById(e){for(const s of this.gridManagers)if(s.id==e)return s;return null}get currentGrid(){return a(i(this,V))}savePresets(){const e=this.gridManagers.map(s=>s.toJSON());J("presets",JSON.stringify(e)),this.hasPresets=!0,this.initialGrids=this.gridManagers}get allIDs(){return a(i(this,j))}}P=new WeakMap,X=new WeakMap,z=new WeakMap,Y=new WeakMap,U=new WeakMap,T=new WeakMap,L=new WeakMap,F=new WeakMap,V=new WeakMap,j=new WeakMap;const ye=new ue;export{I as G,le as W,pe as a,de as d,ye as s,f as v};
