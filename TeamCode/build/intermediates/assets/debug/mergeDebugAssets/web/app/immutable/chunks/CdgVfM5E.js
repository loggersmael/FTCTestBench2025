var ut=Object.defineProperty;var ht=e=>{throw TypeError(e)};var mt=(e,t,s)=>t in e?ut(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var w=(e,t,s)=>mt(e,typeof t!="symbol"?t+"":t,s),pt=(e,t,s)=>t.has(e)||ht("Cannot "+s);var a=(e,t,s)=>(pt(e,t,"read from private field"),s?s.call(e):t.get(e)),r=(e,t,s)=>t.has(e)?ht("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s);import{b as ft,ae as vt,n as Mt,aH as St,G as wt,h as nt,k as yt,aC as h,d as o,a5 as c,a2 as y,W as K,X,V as ct,T as Nt,aG as Ot}from"./DxySB33y.js";import{a as n,p as at,i as At}from"./DQEzFBYC.js";import{t as rt,b as q,e as Rt}from"./DgPgYHzS.js";import{s as bt}from"./DG_-0HLc.js";function ot(e,t,...s){var i=e,l=St,d;ft(()=>{l!==(l=t())&&(d&&(wt(d),d=null),d=Mt(()=>l(i,...s)))},vt),nt&&(i=yt)}const dt=[...` 	
\r\f \v\uFEFF`];function kt(e,t,s){var i=e==null?"":""+e;if(s){for(var l in s)if(s[l])i=i?i+" "+l:l;else if(i.length)for(var d=l.length,m=0;(m=i.indexOf(l,m))>=0;){var u=m+d;(m===0||dt.includes(i[m-1]))&&(u===i.length||dt.includes(i[u]))?i=(m===0?"":i.substring(0,m))+i.substring(u+1):m=u}}return i===""?null:i}function Yt(e,t){return e==null?null:String(e)}function Et(e,t,s,i,l,d){var m=e.__className;if(nt||m!==s){var u=kt(s,i,d);(!nt||u!==e.getAttribute("class"))&&(u==null?e.removeAttribute("class"):t?e.className=u:e.setAttribute("class",u)),e.__className=s}else if(d&&l!==d)for(var M in d){var S=!!d[M];(l==null||S!==!!l[M])&&e.classList.toggle(M,S)}return d}var N,O;class Ft{constructor(){r(this,N,h(n([])));r(this,O,h(null));w(this,"lastTimestamp",0)}get gamepads(){return o(a(this,N))}set gamepads(t){c(a(this,N),n(t))}get current(){return o(a(this,O))}set current(t){c(a(this,O),n(t))}updateGamepads(){this.gamepads=navigator.getGamepads?Array.from(navigator.getGamepads()).filter(t=>t):[],this.gamepads.length?(this.current=this.gamepads[0],this.lastTimestamp<this.current.timestamp&&(console.log("Update: ",this.current),this.lastTimestamp=this.current.timestamp)):this.current=null}getPS4ButtonLabel(t){return{0:"✕",1:"◯",2:"◻",3:"△",4:"L1",5:"R1",6:"L2",7:"R2",8:"Share",9:"Options",10:"L3",11:"R3",12:"D-Pad Up",13:"D-Pad Down",14:"D-Pad Left",15:"D-Pad Right",16:"PS",17:"Touchpad"}[t]||`B${t}`}}N=new WeakMap,O=new WeakMap;const Tt={lines:[],rectangles:[],circles:[]};var A;class Pt{constructor(){w(this,"socket",null);w(this,"url",`ws://${window.location.hostname}:8002`);w(this,"messageHandlers",{});w(this,"reconnectInterval",1e3);w(this,"messageQueue",[]);r(this,A,h("closed"));this.messageQueue=[],this.messageHandlers={}}get state(){return o(a(this,A))}set state(t){c(a(this,A),n(t))}init(){return console.log("ran init"),new Promise((t,s)=>{this.socket||(this.socket=new WebSocket(this.url),this.socket.onopen=()=>{this.state="opened",console.log("Connected to WebSocket."),t(),this.flushQueue()},this.socket.onmessage=i=>{const l=JSON.parse(i.data),d=l.kind;d!="time"&&console.log(l),this.handleMessage(d,l)},this.socket.onerror=i=>{console.error("WebSocket error:",i),s(i)},this.socket.onclose=()=>{this.state="closed",console.log("WebSocket closed. Attempting to reconnect..."),setTimeout(async()=>await this.reconnect(),this.reconnectInterval)})})}async reconnect(){this.state=="closed"&&(console.log("Reconnecting..."),this.socket=null,await this.init())}sendMessage(t){this.socket&&this.socket.readyState===WebSocket.OPEN?this.socket.send(JSON.stringify(t)):(console.warn("WebSocket not open. Queuing message."),this.messageQueue.push(JSON.stringify(t)))}flushQueue(){var t;for(;this.messageQueue.length>0&&((t=this.socket)==null?void 0:t.readyState)===WebSocket.OPEN;)this.socket.send(this.messageQueue.shift())}handleMessage(t,s){const i=this.messageHandlers[t];i?i(s):console.warn(`No handler for message kind: ${t}`)}addMessageHandler(t,s){this.messageHandlers[t]=s}removeMessageHandler(t){delete this.messageHandlers[t]}}A=new WeakMap;var R,b,k,E,F,T,P,H,I,L,G,V,W,z,Z,tt,et,U,st,C,D,j,x,J,Q,$;class Ht{constructor(){r(this,R,h(!1));r(this,b,h(""));r(this,k,h(n([])));r(this,E,h("$Stop$Robot$"));r(this,F,h("stopped"));r(this,T,h(n([])));r(this,P,h(n(Tt)));r(this,H,h(n({})));r(this,I,h(2));r(this,L,h(!1));r(this,G,h(!1));r(this,V,h(!1));r(this,W,h(n([])));r(this,z,y(()=>this.history.length>0));r(this,Z,y(()=>{var t;return((t=this.history.at(0))==null?void 0:t.timestamp)||0}));r(this,tt,y(()=>{var t;return((t=this.history.at(this.history.length-1))==null?void 0:t.timestamp)||0}));r(this,et,y(()=>this.endTimestamp-this.startTimestamp));r(this,U,h(0));r(this,st,y(()=>{var t=0,s=0;for(const i of this.history){if(i.timestamp<=this.timestamp+this.startTimestamp)t=s;else return this.history.at(t);s++}return this.history.at(this.history.length-1)||null}));r(this,C,h(n([])));r(this,D,h(n(new Map)));r(this,j,h(n({})));r(this,x,h(""));r(this,J,h("NORMAL"));r(this,Q,h(-1));r(this,$,h(n([])))}get showSettings(){return o(a(this,R))}set showSettings(t){c(a(this,R),n(t))}get time(){return o(a(this,b))}set time(t){c(a(this,b),n(t))}get opModes(){return o(a(this,k))}set opModes(t){c(a(this,k),n(t))}get activeOpMode(){return o(a(this,E))}set activeOpMode(t){c(a(this,E),n(t))}get activeOpModeStatus(){return o(a(this,F))}set activeOpModeStatus(t){c(a(this,F),n(t))}get telemetry(){return o(a(this,T))}set telemetry(t){c(a(this,T),n(t))}get canvas(){return o(a(this,P))}set canvas(t){c(a(this,P),n(t))}get graphs(){return o(a(this,H))}set graphs(t){c(a(this,H),n(t))}get timeWindow(){return o(a(this,I))}set timeWindow(t){c(a(this,I),n(t))}get isRecording(){return o(a(this,L))}set isRecording(t){c(a(this,L),n(t))}get isPlaying(){return o(a(this,G))}set isPlaying(t){c(a(this,G),n(t))}get isForwarding(){return o(a(this,V))}set isForwarding(t){c(a(this,V),n(t))}get history(){return o(a(this,W))}set history(t){c(a(this,W),n(t))}get hasRecording(){return o(a(this,z))}get startTimestamp(){return o(a(this,Z))}get endTimestamp(){return o(a(this,tt))}get duration(){return o(a(this,et))}get timestamp(){return o(a(this,U))}set timestamp(t){c(a(this,U),n(t))}get entry(){return o(a(this,st))}loop(){this.isPlaying&&this.entry!=null&&(this.telemetry=this.entry.lines,this.canvas=this.entry.canvas,this.graphs=this.entry.graphs)}get jvmFields(){return o(a(this,C))}set jvmFields(t){c(a(this,C),n(t))}get initialJvmFields(){return o(a(this,D))}set initialJvmFields(t){c(a(this,D),n(t))}get openedStates(){return o(a(this,j))}set openedStates(t){c(a(this,j),n(t))}get searchParam(){return o(a(this,x))}set searchParam(t){c(a(this,x),n(t))}get configurablesState(){return o(a(this,J))}set configurablesState(t){c(a(this,J),n(t))}get batteryVoltage(){return o(a(this,Q))}set batteryVoltage(t){c(a(this,Q),n(t))}get flows(){return o(a(this,$))}set flows(t){c(a(this,$),n(t))}}R=new WeakMap,b=new WeakMap,k=new WeakMap,E=new WeakMap,F=new WeakMap,T=new WeakMap,P=new WeakMap,H=new WeakMap,I=new WeakMap,L=new WeakMap,G=new WeakMap,V=new WeakMap,W=new WeakMap,z=new WeakMap,Z=new WeakMap,tt=new WeakMap,et=new WeakMap,U=new WeakMap,st=new WeakMap,C=new WeakMap,D=new WeakMap,j=new WeakMap,x=new WeakMap,J=new WeakMap,Q=new WeakMap,$=new WeakMap;var It=(e=>(e.NORMAL="NORMAL",e.SEARCH="SEARCH",e.DIFF="DIFF",e))(It||{}),B;class Lt{constructor(){r(this,B,h(n([])))}get data(){return o(a(this,B))}set data(t){c(a(this,B),n(t))}add(t){this.data.push({timestamp:Date.now(),text:t})}}B=new WeakMap;var f=(e=>(e.INT="INT",e.DOUBLE="DOUBLE",e.STRING="STRING",e.BOOLEAN="BOOLEAN",e.FLOAT="FLOAT",e.LONG="LONG",e.ENUM="ENUM",e.ARRAY="ARRAY",e.LIST="LIST",e.UNKNOWN="UNKNOWN",e.CUSTOM="CUSTOM",e.MAP="MAP",e.GENERIC="GENERIC",e.GENERIC_NO_ANNOTATION="GENERIC_NO_ANNOTATION",e))(f||{});function it(e,t,s){for(const i of e)(i.type==f.CUSTOM||i.type==f.ARRAY||i.type==f.MAP||i.type==f.LIST)&&Array.isArray(i.customValues)?(s(i),it(i.customValues,t,s)):t(i)}function Gt(e,t,s){return e.map(i=>{if((i.type===f.CUSTOM||i.type===f.ARRAY||i.type===f.MAP||i.type===f.LIST)&&Array.isArray(i.customValues)){const l=Gt(i.customValues,t,s);return s(i,l)}else return t(i)})}const v=new Pt;v.addMessageHandler("time",e=>{g.time=e.time});v.addMessageHandler("opmodes",e=>{g.opModes=e.opModes});v.addMessageHandler("activeOpMode",e=>{g.activeOpMode=e.opMode.name,g.activeOpModeStatus=e.status});const g=new Ht;v.addMessageHandler("telemetryPacket",e=>{const i=new Date(e.timestamp).getTime()-g.timeWindow*1e3,l={};for(const[d,m]of Object.entries(e.graphs)){const u=m.filter(p=>new Date(p.timestamp).getTime()>=i),M=u.length;if(M<=1200){l[d]=u;continue}const S=(M-1)/1199,_=[];for(let p=0;p<1200;p++){const Y=Math.round(p*S);_.push(u[Y])}l[d]=_}g.isPlaying||(g.telemetry=e.lines,g.canvas=e.canvas,g.graphs=l),g.isRecording&&g.history.push({canvas:e.canvas,lines:e.lines,graphs:l,timestamp:e.timestamp})});v.addMessageHandler("jvmFields",e=>{g.jvmFields=e.fields;const t=s=>{s.isShown=!0};it(g.jvmFields,t,t)});v.addMessageHandler("initialJvmFields",e=>{const t=e.fields,s=new Map;function i(l){s.set(l.id,l.valueString)}it(t,i,i),g.initialJvmFields=s});v.addMessageHandler("updatedJvmFields",e=>{it(g.jvmFields,t=>{for(const s of e.fields)t.id==s.id&&(t.valueString=s.newValueString,t.valueString=s.newValueString,t.value=s.newValueString,t.isValid=!0)},t=>{})});v.addMessageHandler("batteryVoltage",e=>{g.batteryVoltage=e.value});v.addMessageHandler("allFlows",e=>{g.flows=e.flows});const Kt=new Ft,Xt=new Lt;var Vt=rt('<div class="header svelte-pv3xha"><!></div>');function Wt(e,t){var s=Vt(),i=K(s);ot(i,()=>t.children),X(s),q(e,s)}var Ut=rt('<h2 class="svelte-opkjd0"><!></h2>');function Ct(e,t){var s=Ut(),i=K(s);ot(i,()=>t.children),X(s),q(e,s)}var Dt=rt('<section><!> <div class="main svelte-kkws1o"><!></div></section>');function qt(e,t){let s=at(t,"title",3,""),i=at(t,"hasMargin",3,!0),l=at(t,"maxHeight",3,!1);var d=Dt();let m;var u=K(d);{var M=p=>{Wt(p,{children:(Y,jt)=>{Ct(Y,{children:(gt,xt)=>{Ot();var lt=Rt();ct(()=>bt(lt,s())),q(gt,lt)}})}})};At(u,p=>{s()!=""&&p(M)})}var S=Nt(u,2),_=K(S);ot(_,()=>t.children),X(S),X(d),ct(p=>m=Et(d,1,"svelte-kkws1o",null,m,p),[()=>({hasMargin:i(),maxHeight:l()})]),q(e,d)}export{It as C,Wt as H,qt as S,Ct as T,ot as a,v as b,f as c,it as d,Gt as f,Kt as g,g as i,Xt as n,Et as s,Yt as t};
