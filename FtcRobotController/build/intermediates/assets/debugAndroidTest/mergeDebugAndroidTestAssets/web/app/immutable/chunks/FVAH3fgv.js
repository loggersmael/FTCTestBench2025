var Ge=Object.defineProperty;var Ae=n=>{throw TypeError(n)};var Re=(n,t,e)=>t in n?Ge(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var w=(n,t,e)=>Re(n,typeof t!="symbol"?t+"":t,e),Oe=(n,t,e)=>t.has(n)||Ae("Cannot "+e);var a=(n,t,e)=>(Oe(n,t,"read from private field"),e?e.call(n):t.get(n)),h=(n,t,e)=>t.has(n)?Ae("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e);import{b as Pe,h as re,d as xe,l as We,n as Ce,a3 as qe,aC as Fe,aB as Je,i as Ke,P as Ue,A as je,v as Ze,x as Ee,w as Se,af as Qe,aH as $e,aI as et,G as f,o as d,D as tt,t as V,c as p,r as M,p as ee,a8 as le,f as Xe,s as pe,q as E,a as te,z as nt,a9 as v,aG as it}from"./DImaOtgy.js";import{b as Ve,e as st,n as rt,a as I,t as T}from"./CpjUEfFn.js";import{s as oe}from"./DLWnW4oO.js";import{p as c}from"./BSpBZuls.js";import{l as lt,d as we,s as ye}from"./vuGbUGSM.js";import{s as he}from"./BxwBtVRA.js";import{s as D,T as Y}from"./DkGOhSJJ.js";import{s as ot,r as at,e as ut,i as dt}from"./D9FDE-on.js";import{b as ae}from"./ExJb-yR2.js";import{o as Be}from"./B9Netn4Y.js";import{p as m}from"./CyCUbHaQ.js";import{s as x}from"./lRqNagYI.js";import{i as ct}from"./CQpEsQrD.js";import{s as ht}from"./BjlxBxgQ.js";import{i as ft}from"./JW_WWkOz.js";function vt(n,t,e,i,r){var s=n,l="",o;Pe(()=>{if(l===(l=t()??"")){re&&xe();return}o!==void 0&&(je(o),o=void 0),l!==""&&(o=We(()=>{if(re){Ce.data;for(var u=xe(),g=u;u!==null&&(u.nodeType!==8||u.data!=="");)g=u,u=qe(u);if(u===null)throw Fe(),Je;Ve(Ce,g),s=Ke(u);return}var b=l+"",k=st(b);Ve(Ue(k),k.lastChild),s.before(k)}))})}function gt(n,t,e,i,r){var o;re&&xe();var s=(o=t.$$slots)==null?void 0:o[e],l=!1;s===!0&&(s=t.children,l=!0),s===void 0||s(n,l?()=>i:i)}function mt(n,t,e){Ze(()=>{var i=Ee(()=>t(n,e==null?void 0:e())||{});if(e&&(i!=null&&i.update)){var r=!1,s={};Se(()=>{var l=e();Qe(l),r&&$e(s,l)&&(s=l,i.update(l))}),r=!0}if(i!=null&&i.destroy)return()=>i.destroy()})}function Mt(n,t,e=t){var i=et();lt(n,"input",r=>{var s=r?n.defaultValue:n.value;if(s=ge(n)?me(s):s,e(s),i&&s!==(s=t())){var l=n.selectionStart,o=n.selectionEnd;n.value=s??"",o!==null&&(n.selectionStart=l,n.selectionEnd=Math.min(o,n.value.length))}}),(re&&n.defaultValue!==n.value||Ee(t)==null&&n.value)&&e(ge(n)?me(n.value):n.value),Se(()=>{var r=t();ge(n)&&r===me(n.value)||n.type==="date"&&!r&&!n.value||r!==n.value&&(n.value=r??"")})}function ge(n){var t=n.type;return t==="number"||t==="range"}function me(n){return n===""?null:+n}function vn(n){var t=tt(0);return function(){return arguments.length===1?(f(t,d(t)+1),arguments[0]):(d(t),n())}}var xt=rt('<svg width="100%" height="100%" viewBox="0 0 11 7" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M9.072,0.031l0.335,0.001c0.32,0.001 0.608,0.193 0.733,0.488c0.125,0.295 0.063,0.635 -0.159,0.866l-4.287,4.465c-0.15,0.157 -0.359,0.245 -0.577,0.245c-0.217,0 -0.426,-0.088 -0.577,-0.245l-4.317,-4.497c-0.222,-0.232 -0.285,-0.574 -0.158,-0.869c0.126,-0.295 0.417,-0.486 0.738,-0.485l0.331,0.001l3.406,3.547c0.151,0.158 0.36,0.246 0.577,0.246c0.218,0 0.427,-0.088 0.577,-0.246l3.378,-3.517Z" class="svelte-17tzrkq"></path></svg>');function gn(n,t){let e=c(t,"isVertical",3,!0);var i=xt();let r;V(s=>r=oe(i,0,"svelte-17tzrkq",null,r,s),[()=>({opened:t.isOpened,vertical:e()})]),I(n,i)}var pt=T('<button class="svelte-1am2ynb"><!></button>');function mn(n,t){let e=c(t,"disabled",3,!1),i=c(t,"onclick",3,()=>{});var r=pt();r.__click=function(...l){var o;(o=i())==null||o.apply(this,l)};var s=p(r);he(s,()=>t.children),M(r),V(()=>r.disabled=e()),I(n,r)}we(["click"]);var yt=T('<div><div class="content svelte-1tl1pl2"><!></div></div>');function Ye(n,t){let e=c(t,"isValid",3,!0);var i=yt();let r;var s=p(i),l=p(s);he(l,()=>t.children),M(s),M(i),V(o=>{r=oe(i,1,"field svelte-1tl1pl2",null,r,o),ot(i,"data-type",t.type)},[()=>({invalid:!e()})]),I(n,i)}var _t=(n,t,e)=>{t(),e()()},wt=T('<div class="flex svelte-2iw5vb"><input type="text" autocorrect="off" spellcheck="false" class="svelte-2iw5vb"> <span class="extra svelte-2iw5vb"> </span></div>'),It=T('<!> <span class="helper svelte-2iw5vb"><!></span>',1);function bt(n,t){ee(t,!0);let e=c(t,"text",15),i=c(t,"extraChar",3,""),r=c(t,"type",3,""),s=c(t,"isValid",3,!0),l=c(t,"oninput",3,()=>{}),o=c(t,"alwaysValid",3,!1);Be(()=>{u()});function u(){b.style.width=Math.max(g.offsetWidth+2,100)+"px"}le(()=>{var y;((y=e())==null?void 0:y.length)>0||u()});let g,b;var k=It(),ve=Xe(k);const ne=E(()=>s()||o());Ye(ve,{get type(){return r()},get isValid(){return d(ne)},children:(y,Ie)=>{var S=wt(),_=p(S);at(_),_.__input=[_t,u,l],ae(_,C=>b=C,()=>b);var ie=pe(_,2),be=p(ie,!0);M(ie),M(S),V(()=>ye(be,i())),Mt(_,e),I(y,S)},$$slots:{default:!0}});var A=pe(ve,2),z=p(A);vt(z,()=>{var y;return(y=e())==null?void 0:y.replaceAll(" ","&nbsp;")}),M(A),ae(A,y=>g=y,()=>g),I(n,k),te()}we(["input"]);function Mn(n,t){ee(t,!0);let e=c(t,"currentValue",15),i=c(t,"isValid",15),r=c(t,"value",15),s=c(t,"validate",3,b=>!0),l=c(t,"extraChar",3,""),o=c(t,"type",3,""),u=c(t,"alwaysValid",3,!1);le(()=>{r()==null&&(r(t.startValue),i(s()(r())))}),le(()=>{if(D.state=="closed"||D.state=="opened"){if(!s()(r())){i(!1);return}i(!0)}});const g=E(()=>i()||D.state=="opened"||u());bt(n,{get type(){return o()},oninput:()=>{if(!s()(r())){i(!1);return}i(!0),e(r())},get isValid(){return d(g)},get extraChar(){return l()},get text(){return r()},set text(b){r(b)}}),te()}const Tt=-2147483648,kt=2147483647,At=BigInt("-9223372036854775808"),Ct=BigInt("9223372036854775807"),Vt=-34e37,zt=34e37,Dt=-17e307,Et=17e307;function St(n){for(const e of n)if(!["0","1","2","3","4","5","6","7","8","9"].includes(e))return!1;const t=parseInt(n,10);return isNaN(t)?!1:t>=Tt&&t<=kt}function Xt(n){for(const e of n)if(!["0","1","2","3","4","5","6","7","8","9"].includes(e))return!1;const t=BigInt(n);return t>=At&&t<=Ct}function Bt(n){var t=!1;for(const i of n){if(!["0","1","2","3","4","5","6","7","8","9","."].includes(i))return!1;if(i==".")if(!t)t=!0;else return!1}const e=parseFloat(n);return isNaN(e)?!1:e>=Dt&&e<=Et}function Yt(n){var t=!1;for(const i of n){if(!["0","1","2","3","4","5","6","7","8","9","."].includes(i))return!1;if(i==".")if(!t)t=!0;else return!1}const e=parseFloat(n);return isNaN(e)?!1:e>=Vt&&e<=zt}function ze(n){return typeof n=="string"}function Lt(n){return!1}function xn(n){if(D.state=="closed")return Lt;switch(n){case Y.INT:return St;case Y.LONG:return Xt;case Y.DOUBLE:return Bt;case Y.FLOAT:return Yt;case Y.STRING:return ze;default:return ze}}var Nt=T('<div class="context-menu svelte-zwo7g9"><!></div>');function pn(n,t){ee(t,!0);let e=null;function i(){if(!e)return"";const l=e.getBoundingClientRect(),u=document.querySelectorAll(`.widget[data-id="${t.id}"]`)[0].getBoundingClientRect(),g=l.right>u.right-8;return console.log(g),g?(e.style.left="auto",e.style.right="0"):(e.style.left="0",e.style.right="auto"),""}Be(()=>{i()});var r=Nt(),s=p(r);he(s,()=>t.children??nt),M(r),ae(r,l=>e=l,()=>e),I(n,r),te()}var L,N;class fe{constructor(){h(this,L,v(0));h(this,N,v(0))}get mouseX(){return d(a(this,L))}set mouseX(t){f(a(this,L),m(t))}get mouseY(){return d(a(this,N))}set mouseY(t){f(a(this,N),m(t))}}L=new WeakMap,N=new WeakMap;var H,G;class Ht extends fe{constructor(){super(...arguments);h(this,H,v(null));h(this,G,v(null))}get openedContextMenuID(){return d(a(this,H))}set openedContextMenuID(e){f(a(this,H),m(e))}get openedContextMenuIndex(){return d(a(this,G))}set openedContextMenuIndex(e){f(a(this,G),m(e))}openContextMenu(e,i){this.openedContextMenuID=e,this.openedContextMenuIndex=i}closeContextMenu(){this.openedContextMenuID=null,this.openedContextMenuIndex=null}isContextOpened(e,i){return this.openedContextMenuID==e&&this.openedContextMenuIndex==i}onMouseMove(e){}onClick(e){const i=e.target;i.closest(".context-menu")||i.closest(".keepOpened")||this.closeContextMenu()}onKey(e){e.key==="Escape"&&this.closeContextMenu()}}H=new WeakMap,G=new WeakMap;var R,ue,O,P;class Gt extends fe{constructor(){super(...arguments);h(this,R,v(null));h(this,ue,E(()=>this.movingModule!=null));h(this,O,v(null));h(this,P,v(null))}get movingModule(){return d(a(this,R))}set movingModule(e){f(a(this,R),m(e))}get isMov(){return d(a(this,ue))}get xTile(){return d(a(this,O))}set xTile(e){f(a(this,O),m(e))}get yTile(){return d(a(this,P))}set yTile(e){f(a(this,P),m(e))}startMov(e,i,r){this.movingModule=e;const l=document.querySelectorAll(`.widget[data-id="${e.id}"]`)[0].getBoundingClientRect();this.xTile=Math.ceil((i-l.x)/l.width*e.sizes.x)-1,this.yTile=Math.ceil((r-l.y)/l.height*e.sizes.y)-1}canMov(e,i){if(!this.isMov||this.xTile==null||this.yTile==null||!this.movingModule)return!1;const r=e-this.xTile,s=i-this.yTile;if(r==this.movingModule.start.x&&s==this.movingModule.start.y)return!1;for(let l=r;l<r+this.movingModule.sizes.x;l++)for(let o=s;o<s+this.movingModule.sizes.y;o++)if(l>x.currentGrid.cellsX||o>x.currentGrid.cellsY||l<1||o<1||x.currentGrid.widgetsMap[o][l]!=null&&x.currentGrid.widgetsMap[o][l]!=this.movingModule.id)return!1;return!0}onMouseMove(e){if(this.movingModule!=null){const r=document.elementsFromPoint(e.clientX,e.clientY).filter(s=>s instanceof HTMLElement&&s.classList.contains("overlay-item")&&s.classList.contains("isShown")&&s.hasAttribute("data-x")&&s.hasAttribute("data-y"))[0];if(r!=null){let s=r.getAttribute("data-x"),l=r.getAttribute("data-y");if(s==null||l==null||this.xTile==null||this.yTile==null)return;const o=parseInt(s),u=parseInt(l);if(!this.canMov(o,u))return;this.movingModule.start={x:o-this.xTile,y:u-this.yTile}}}}onClick(e){this.onMouseMove(e),this.movingModule=null,this.xTile=null,this.yTile=null}onKey(e){}}R=new WeakMap,ue=new WeakMap,O=new WeakMap,P=new WeakMap;var W,de;class Rt extends fe{constructor(){super(...arguments);h(this,W,v(null));h(this,de,E(()=>this.resizingModule!=null))}get resizingModule(){return d(a(this,W))}set resizingModule(e){f(a(this,W),m(e))}get isResizing(){return d(a(this,de))}startResizing(e){this.resizingModule=e}canResize(e,i){if(this.resizingModule==null||e<this.resizingModule.start.x||i<this.resizingModule.start.y||e==this.resizingModule.start.x+this.resizingModule.sizes.x-1&&i==this.resizingModule.start.y+this.resizingModule.sizes.y-1)return!1;for(let r=this.resizingModule.start.x;r<=e;r++)for(let s=this.resizingModule.start.y;s<=i;s++)if(r>x.currentGrid.cellsX||s>x.currentGrid.cellsY||r<1||s<1||x.currentGrid.widgetsMap[s][r]!=null&&x.currentGrid.widgetsMap[s][r]!=this.resizingModule.id)return!1;return!0}onMouseMove(e){if(this.resizingModule!=null){const r=document.elementsFromPoint(e.clientX,e.clientY).filter(s=>s instanceof HTMLElement&&s.classList.contains("overlay-item")&&s.classList.contains("isShown")&&s.hasAttribute("data-x")&&s.hasAttribute("data-y"))[0];if(r!=null){let s=r.getAttribute("data-x"),l=r.getAttribute("data-y");if(s==null||l==null)return;const o=parseInt(s),u=parseInt(l);if(!this.canResize(o,u))return;this.resizingModule.sizes={x:o-this.resizingModule.start.x+1,y:u-this.resizingModule.start.y+1}}}}onClick(e){this.onMouseMove(e),this.resizingModule=null}onKey(e){throw new Error("Method not implemented.")}}W=new WeakMap,de=new WeakMap;var _e=(n=>(n.WIDGETS="widgets",n.PRESETS="presets",n))(_e||{}),q,F,J,K,U,j,Z,Q,$,ce;class De extends fe{constructor(e){super();w(this,"type");h(this,q,v(null));h(this,F,v(null));h(this,J,v(null));h(this,K,v(null));h(this,U,v(0));h(this,j,v(0));h(this,Z,v(null));h(this,Q,v(null));h(this,$,v(!1));h(this,ce,E(()=>{if(!this.startX||!this.startY)return!1;if(this.wasStartedMoving)return!0;let e=Math.abs(this.mouseX-this.startX),i=Math.abs(this.mouseY-this.startY);return Math.sqrt(e*e+i*i)>32?(this.wasStartedMoving=!0,!0):!1}));this.type=e}get movingIndex(){return d(a(this,q))}set movingIndex(e){f(a(this,q),m(e))}get movingID(){return d(a(this,F))}set movingID(e){f(a(this,F),m(e))}get hoveringIndex(){return d(a(this,J))}set hoveringIndex(e){f(a(this,J),m(e))}get hoveringID(){return d(a(this,K))}set hoveringID(e){f(a(this,K),m(e))}get mouseX(){return d(a(this,U))}set mouseX(e){f(a(this,U),m(e))}get mouseY(){return d(a(this,j))}set mouseY(e){f(a(this,j),m(e))}get startX(){return d(a(this,Z))}set startX(e){f(a(this,Z),m(e))}get startY(){return d(a(this,Q))}set startY(e){f(a(this,Q),m(e))}get wasStartedMoving(){return d(a(this,$))}set wasStartedMoving(e){f(a(this,$),m(e))}get isMoving(){return d(a(this,ce))}showExtra(e,i){return this.isMoving?this.movingID!=e?!0:this.movingIndex==i||this.movingIndex==i-1?!1:this.movingIndex!=i:!1}showLabel(e,i){return!this.isMoving||this.movingID!=e||this.movingIndex!=i}startMoving(e,i,r,s){this.startX=e,this.startY=i,this.movingIndex=r,this.movingID=s,this.hoveringID=null,this.hoveringIndex=null,this.wasStartedMoving=!1}onMouseMove(e){if(this.hoveringID=null,this.hoveringIndex=null,this.mouseX=e.clientX,this.mouseY=e.clientY,!this.isMoving)return;const r=document.elementsFromPoint(e.clientX,e.clientY).filter(s=>s instanceof HTMLElement&&s.hasAttribute("data-id")&&s.hasAttribute("data-index"));for(const s of r){const l=s.getAttribute("data-id"),o=s.getAttribute("data-index");if(!o)continue;const u=parseInt(o);if(l!=null&&u!=null){this.hoveringID=l,this.hoveringIndex=u;return}}}moveItem(e,i,r,s){r<s&&e===i&&(s-=1);const[l]=e.splice(r,1);i.splice(s,0,l)}onClick(e){if(this.hoveringID!=null&&this.hoveringIndex!=null){if(this.type=="widgets"){const i=x.currentGrid.widgets.find(s=>s.id==this.movingID),r=x.currentGrid.widgets.find(s=>s.id==this.hoveringID);i&&r&&this.movingIndex!=null&&i.widgets[this.movingIndex]&&(this.moveItem(i.widgets,r.widgets,this.movingIndex,this.hoveringIndex),i.activeWidgetID==this.movingIndex&&(i.activeWidgetID>0?i.activeWidgetID=i.activeWidgetID-1:i.activeWidgetID=0))}else if(this.type=="presets"&&this.movingIndex!=null&&this.hoveringIndex!=null){const i=[...x.presets];this.moveItem(i,i,this.movingIndex,this.hoveringIndex),x.presets=i}}this.wasStartedMoving=!1,this.startX=null,this.startY=null,this.movingIndex=null,this.movingID=null,this.hoveringID=null,this.hoveringIndex=null}onKey(e){}}q=new WeakMap,F=new WeakMap,J=new WeakMap,K=new WeakMap,U=new WeakMap,j=new WeakMap,Z=new WeakMap,Q=new WeakMap,$=new WeakMap,ce=new WeakMap;class Ot{constructor(){w(this,"context",new Ht);w(this,"moving",new Gt);w(this,"resizing",new Rt);w(this,"tabs",new De(_e.WIDGETS));w(this,"sidebarTabs",new De(_e.PRESETS));w(this,"dependencies",[this.context,this.moving,this.resizing,this.tabs,this.sidebarTabs]);w(this,"moveBoundHandler");w(this,"upBoundHandler");w(this,"keyBoundHandler")}onMouseMove(t){for(const e of this.dependencies)e.onMouseMove(t),e.mouseX=t.clientX,e.mouseY=t.clientY}onClick(t){for(const e of this.dependencies)e.onClick(t)}onKey(t){for(const e of this.dependencies)e.onKey(t)}init(){this.moveBoundHandler=this.onMouseMove.bind(this),this.upBoundHandler=this.onClick.bind(this),this.keyBoundHandler=this.onKey.bind(this),window.addEventListener("mousemove",this.moveBoundHandler),window.addEventListener("mouseup",this.upBoundHandler),window.addEventListener("keydown",this.keyBoundHandler)}destroy(){window.removeEventListener("mousemove",this.moveBoundHandler),window.removeEventListener("mouseup",this.upBoundHandler),window.removeEventListener("keydown",this.keyBoundHandler)}showWidget(t,e){return this.resizing.canResize(t,e)||this.moving.canMov(t,e)}}let yn=new Ot;var Pt=T('<div class="header svelte-h3jx70"><!></div>');function _n(n,t){var e=Pt(),i=p(e);he(i,()=>t.children),M(e),I(n,e)}function Me(n,t="body"){let e;async function i(s){if(t=s,typeof t=="string"){if(e=document.querySelector(t),e===null&&(await it(),e=document.querySelector(t)),e===null)throw new Error(`No element found matching css selector: "${t}"`)}else if(t instanceof HTMLElement)e=t;else throw new TypeError(`Unknown portal target type: ${t===null?"null":typeof t}. Allowed types: string (CSS selector) or HTMLElement.`);e.appendChild(n),n.hidden=!1}function r(){n.parentNode&&n.parentNode.removeChild(n)}return i(t),{update:i,destroy:r}}var Wt=T("<div hidden><!></div>");function qt(n,t){ee(t,!1);let e=c(t,"target",8,"body");ft();var i=Wt(),r=p(i);gt(r,t,"default",{}),M(i),mt(i,(s,l)=>Me==null?void 0:Me(s,l),e),I(n,i),te()}var Ft=(n,t)=>{f(t,!d(t))},Jt=(n,t,e,i,r,s)=>{D.state=="closed"&&!t()||(e(d(i)),r(d(i)),f(s,!1))},Kt=T("<button> </button>"),Ut=T("<div></div>"),jt=T('<div class="content svelte-1pwgpn0"><button class="svelte-1pwgpn0"> </button></div> <!>',1);function wn(n,t){ee(t,!0);let e=c(t,"currentValue",15),i=c(t,"isValid",15),r=c(t,"value",15),s=c(t,"type",3,"ENUM"),l=c(t,"alwaysValid",3,!1),o=c(t,"keepOpened",3,!1);le(()=>{r()==null&&(r(t.startValue),i(!0))});let u=v(!1),g=null;const b=E(()=>D.state=="opened"||l());Ye(n,{get type(){return s()},get isValid(){return d(b)},children:(k,ve)=>{var ne=jt(),A=Xe(ne),z=p(A);z.__click=[Ft,u];var y=p(z,!0);M(z),ae(z,_=>g=_,()=>g),M(A);var Ie=pe(A,2);{var S=_=>{qt(_,{children:(ie,be)=>{var C=Ut();let Te;ut(C,21,()=>t.possibleValues.filter(X=>X!=e()),dt,(X,se,Le)=>{var B=Kt();B.__click=[Jt,l,e,se,r,u];let ke;var Ne=p(B,!0);M(B),V(He=>{ke=oe(B,1,"svelte-1pwgpn0",null,ke,He),ye(Ne,d(se))},[()=>({keepOpened:o(),first:Le==0})]),I(X,B)}),M(C),V((X,se)=>{Te=oe(C,1,"select svelte-1pwgpn0",null,Te,X),ht(C,se)},[()=>({keepOpened:o()}),()=>`top: ${g.getBoundingClientRect().bottom}px; left: ${g.getBoundingClientRect().left}px;`]),I(ie,C)},$$slots:{default:!0}})};ct(Ie,_=>{d(u)&&g&&_(S)})}V(()=>ye(y,e())),I(k,ne)},$$slots:{default:!0}}),te()}we(["click"]);export{gn as A,mn as B,pn as C,_n as H,qt as P,Mn as S,wn as a,xn as b,Mt as c,vt as h,yn as m,vn as r,ze as s};
