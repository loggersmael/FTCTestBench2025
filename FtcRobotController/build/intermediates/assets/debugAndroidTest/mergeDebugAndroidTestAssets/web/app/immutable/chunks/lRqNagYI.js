var j=e=>{throw TypeError(e)};var W=(e,t,s)=>t.has(e)||j("Cannot "+s);var i=(e,t,s)=>(W(e,t,"read from private field"),s?s.call(e):t.get(e)),a=(e,t,s)=>t.has(e)?j("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s);import{a9 as h,o as d,G as u,q as C}from"./DImaOtgy.js";import{p as r}from"./CyCUbHaQ.js";import{n as V}from"./DkGOhSJJ.js";const l=[];for(let e=0;e<256;++e)l.push((e+256).toString(16).slice(1));function K(e,t=0){return(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase()}let $;const Q=new Uint8Array(16);function Z(){if(!$){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");$=crypto.getRandomValues.bind(crypto)}return $(Q)}const _=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),H={randomUUID:_};function p(e,t,s){var c;if(H.randomUUID&&!e)return H.randomUUID();e=e||{};const n=e.random??((c=e.rng)==null?void 0:c.call(e))??Z();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,K(n)}const ot=["Custom","OpMode Control","Gamepad","Field","Telemetry","Configurables","Graph","Capture","Test"];var q=(e=>(e.CONTROLS="OpMode Control",e.GAMEPAD="Gamepad",e.FIELD="Field",e.TELEMETRY="Telemetry",e.CONFIGURABLES="Configurables",e.GRAPH="Graph",e.CAPTURE="Capture",e.CUSTOM="Custom",e.TEST="Test",e))(q||{});function tt(){return{id:p(),name:"Default",xSize:20,ySize:20,groups:[{id:p(),activeWidgetID:0,widgets:[{type:"OpMode Control"}],start:{x:1,y:1},sizes:{x:6,y:5}},{id:p(),activeWidgetID:0,widgets:[{type:"Capture"}],start:{x:7,y:1},sizes:{x:5,y:8}},{id:p(),activeWidgetID:0,widgets:[{type:"Gamepad"}],start:{x:1,y:6},sizes:{x:6,y:5}},{id:p(),activeWidgetID:0,widgets:[{type:"Telemetry"},{type:"Graph"}],start:{x:1,y:11},sizes:{x:6,y:10}},{id:p(),activeWidgetID:0,widgets:[{type:"Field"}],start:{x:7,y:9},sizes:{x:5,y:12}},{id:p(),activeWidgetID:0,widgets:[{type:"Configurables"}],start:{x:12,y:1},sizes:{x:9,y:20}}]}}var S,D,I,M,E,R,Y;const B=class B{constructor(t){a(this,S,h(8));a(this,D,h(6));a(this,I,h("Default"));a(this,M,h(""));a(this,E,h(r([])));a(this,R,C(()=>this.updateMap(this.widgets)));a(this,Y,C(()=>{var t=0;for(const s of this.widgets)t+=s.sizes.x*s.sizes.y;return t}));t==null&&(t=tt()),this.id=t.id,this.name=t.name,this.cellsX=t.xSize,this.cellsY=t.ySize,this.widgets=t.groups}get cellsX(){return d(i(this,S))}set cellsX(t){u(i(this,S),r(t))}get cellsY(){return d(i(this,D))}set cellsY(t){u(i(this,D),r(t))}get name(){return d(i(this,I))}set name(t){u(i(this,I),r(t))}get id(){return d(i(this,M))}set id(t){u(i(this,M),r(t))}get widgets(){return d(i(this,E))}set widgets(t){u(i(this,E),r(t))}get widgetsMap(){return d(i(this,R))}updateMap(t){let s=0,n=0;for(const o of t)s=Math.max(s,o.start.x+o.sizes.x),n=Math.max(n,o.start.y+o.sizes.y);const c=[];for(let o=1;o<this.cellsY+1;o++){c[o]=[];for(let g=1;g<this.cellsX+1;g++)c[o][g]=null}for(const o of t)for(let g=0;g<o.sizes.x;g++)for(let y=0;y<o.sizes.y;y++){const L=o.start.x+g,f=o.start.y+y;c[f][L]=o.id}return c}get cellsCount(){return d(i(this,Y))}canExpand(t,s,n){var L;const{x:c,y:o}=t.start,{x:g,y}=t.sizes;for(let f=0;f<(s!==0?y:g);f++){const A=c+(s===1?g:s===-1?-1:f),F=o+(n===1?y:n===-1?-1:f);if(A<1||A>this.cellsX||F<1||F>this.cellsY||((L=this.widgetsMap[F])==null?void 0:L[A])!==null)return!1}return!0}canExpandRight(t){return this.canExpand(t,1,0)}canExpandLeft(t){return this.canExpand(t,-1,0)}canExpandDown(t){return this.canExpand(t,0,1)}canExpandUp(t){return this.canExpand(t,0,-1)}remove(t){this.widgets=this.widgets.filter(s=>s.id!=t)}addNewAnywhere(){var t;for(let s=1;s<=this.cellsY;s++)for(let n=1;n<=this.cellsX;n++)if(((t=this.widgetsMap[s])==null?void 0:t[n])==null){this.addNew(n,s);return}V.add("No available space in the grid.")}addNew(t,s){if(this.widgetsMap[s][t]!=null){V.add("Slot is already in use.");return}this.widgets.push({id:p(),activeWidgetID:0,widgets:[{type:q.TEST}],start:{x:t,y:s},sizes:{x:1,y:1}})}static fromJSON(t){return new B(t)}toJSON(){return{id:this.id,name:this.name,xSize:this.cellsX,ySize:this.cellsY,groups:this.widgets}}};S=new WeakMap,D=new WeakMap,I=new WeakMap,M=new WeakMap,E=new WeakMap,R=new WeakMap,Y=new WeakMap;let w=B;function x(e,t,s=31536e3){document.cookie=`${e}=${t}; path=/; max-age=${s}`}function m(e){const t=document.cookie.match(new RegExp(`(?:^|; )${e.replace(/([.$?*|{}()[]\/+^])/g,"\\$1")}=([^;]*)`));return t?decodeURIComponent(t[1]):null}function et(e){document.cookie=`${e}=; path=/; max-age=0`}var P,v,O,z,b,k,U,G,N,X,J,T;class st{constructor(){a(this,P,h(m("theme")==="dark"));a(this,v,h(r(m("animations")||"fast")));a(this,O,h(r(m("primary")||"blue")));a(this,z,h(r(m("fieldOrientation")||"0deg")));a(this,b,h(r(m("fieldShowCoordinates")||"false")));a(this,k,h(r(!!m("presets"))));a(this,U,h("default"));a(this,G,h(r(this.getInitialPresetManagers())));a(this,N,h(r(this.getInitialPresetManagers())));a(this,X,C(()=>JSON.stringify(this.initialPresets)!=JSON.stringify(this.presets)));a(this,J,C(()=>{const t=this.getPresetById(this.selectedManagerID);return t??(this.selectedManagerID=this.presets[0].id,this.presets[0])}));a(this,T,C(()=>this.presets.map(t=>t.id)));document.body.classList.toggle("dark-mode",this.isDark),document.body.classList.add(this.animationSpeed)}get isDark(){return d(i(this,P))}set isDark(t){u(i(this,P),r(t))}get animationSpeed(){return d(i(this,v))}set animationSpeed(t){u(i(this,v),r(t))}get primaryColor(){return d(i(this,O))}set primaryColor(t){u(i(this,O),r(t))}get fieldOrientation(){return d(i(this,z))}set fieldOrientation(t){u(i(this,z),r(t))}get fieldShowCoordinates(){return d(i(this,b))}set fieldShowCoordinates(t){u(i(this,b),r(t))}toggleIsDark(){this.isDark=!this.isDark,document.body.classList.toggle("dark-mode",this.isDark),x("theme",this.isDark?"dark":"light")}setSpeed(t){document.body.classList.remove(this.animationSpeed),this.animationSpeed=t,document.body.classList.add(this.animationSpeed),x("animations",t)}setPrimaryColor(t){document.body.classList.remove(this.primaryColor),this.primaryColor=t,document.body.classList.add(this.primaryColor),x("primary",this.primaryColor)}setFieldOrientation(t){this.fieldOrientation=t,x("fieldOrientation",t)}setFieldShowCoordinates(t){this.fieldShowCoordinates=t,x("fieldShowCoordinates",t)}getInitialPresetManagers(){const t=m("presets"),s=t?JSON.parse(t):[null],n=[];for(const[c,o]of Object.entries(s))n.push(w.fromJSON(o));return n.length<1?[new w(null)]:n}resetPresets(){this.selectedManagerID="default",et("presets"),this.presets=[new w(null)],this.initialPresets=[new w(null)],this.hasPresets=!1}removePreset(t){if(this.presets.length==1){V.add("Cannot remove last preset.");return}this.presets=this.presets.filter(s=>s.id!=t)}get hasPresets(){return d(i(this,k))}set hasPresets(t){u(i(this,k),r(t))}get selectedManagerID(){return d(i(this,U))}set selectedManagerID(t){u(i(this,U),r(t))}get initialPresets(){return d(i(this,G))}set initialPresets(t){u(i(this,G),r(t))}get presets(){return d(i(this,N))}set presets(t){u(i(this,N),r(t))}get isGridEdited(){return d(i(this,X))}getPresetById(t){for(const s of this.presets)if(s.id==t)return s;return null}get currentGrid(){return d(i(this,J))}savePresets(){const t=this.presets.map(s=>s.toJSON());x("presets",JSON.stringify(t)),this.hasPresets=!0,this.initialPresets=this.presets}get allIDs(){return d(i(this,T))}}P=new WeakMap,v=new WeakMap,O=new WeakMap,z=new WeakMap,b=new WeakMap,k=new WeakMap,U=new WeakMap,G=new WeakMap,N=new WeakMap,X=new WeakMap,J=new WeakMap,T=new WeakMap;const dt=new st;export{w as P,q as W,ot as a,tt as d,dt as s,p as v};
