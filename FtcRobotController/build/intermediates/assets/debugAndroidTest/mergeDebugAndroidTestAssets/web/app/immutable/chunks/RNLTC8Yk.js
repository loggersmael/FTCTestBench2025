var Z=t=>{throw TypeError(t)};var te=(t,e,s)=>e.has(t)||Z("Cannot "+s);var i=(t,e,s)=>(te(t,e,"read from private field"),s?s.call(t):e.get(t)),n=(t,e,s)=>e.has(t)?Z("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s);import{aK as c,z as a,a3 as g,A as M}from"./7Wps0LQi.js";import{p as l}from"./CZks-J6W.js";import{n as K,i as se}from"./BCFa5w4G.js";const h=[];for(let t=0;t<256;++t)h.push((t+256).toString(16).slice(1));function ie(t,e=0){return(h[t[e+0]]+h[t[e+1]]+h[t[e+2]]+h[t[e+3]]+"-"+h[t[e+4]]+h[t[e+5]]+"-"+h[t[e+6]]+h[t[e+7]]+"-"+h[t[e+8]]+h[t[e+9]]+"-"+h[t[e+10]]+h[t[e+11]]+h[t[e+12]]+h[t[e+13]]+h[t[e+14]]+h[t[e+15]]).toLowerCase()}let j;const re=new Uint8Array(16);function ne(){if(!j){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");j=crypto.getRandomValues.bind(crypto)}return j(re)}const ae=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ee={randomUUID:ae};function p(t,e,s){var o;if(ee.randomUUID&&!t)return ee.randomUUID();t=t||{};const d=t.random??((o=t.rng)==null?void 0:o.call(t))??ne();if(d.length<16)throw new Error("Random bytes length must be >= 16");return d[6]=d[6]&15|64,d[8]=d[8]&63|128,ie(d)}const ye=["OpMode Control","Gamepad","Field","Telemetry","Configurables","Graph","Capture","LL Dash","LL Feed","Test"];var le=(t=>(t.CONTROLS="OpMode Control",t.GAMEPAD="Gamepad",t.FIELD="Field",t.TELEMETRY="Telemetry",t.CONFIGURABLES="Configurables",t.GRAPH="Graph",t.CAPTURE="Capture",t.LIMELIGHT_DASH="LL Dash",t.LIMELIGHT_FEED="LL Feed",t.TEST="Test",t))(le||{});function de(){return{id:p(),name:"Default",x:10,y:10,modules:[{id:p(),type:"OpMode Control",start:{x:1,y:1},sizes:{x:3,y:2}},{id:p(),type:"Capture",start:{x:1,y:3},sizes:{x:3,y:4}},{id:p(),type:"Gamepad",start:{x:1,y:7},sizes:{x:3,y:4}},{id:p(),type:"Field",start:{x:4,y:1},sizes:{x:3,y:4}},{id:p(),type:"Telemetry",start:{x:4,y:5},sizes:{x:3,y:2}},{id:p(),type:"Graph",start:{x:4,y:7},sizes:{x:3,y:4}},{id:p(),type:"Configurables",start:{x:7,y:1},sizes:{x:4,y:6}},{id:p(),type:"LL Feed",start:{x:7,y:7},sizes:{x:4,y:2}},{id:p(),type:"LL Dash",start:{x:7,y:9},sizes:{x:4,y:2}}]}}var D,L,E,k,G,S,v,w,J,T,z,W,$;const _=class _{constructor(e){n(this,D,c(8));n(this,L,c(6));n(this,E,c("Default"));n(this,k,c(""));n(this,G,c(!1));n(this,S,c(-1));n(this,v,c(-1));n(this,w,c(""));n(this,J,M(()=>this.getWidgetById(this.selectedWidgetId)));n(this,T,M(()=>this.checkPlace(this.selectedWidget)));n(this,z,c(l([])));n(this,W,M(()=>this.updateMap(this.modules)));n(this,$,M(()=>{var e=0;for(const s of this.modules)e+=s.sizes.x*s.sizes.y;return e}));e==null&&(e=de()),this.id=e.id,this.name=e.name,this.cellsX=e.x,this.cellsY=e.y,this.modules=e.modules}get cellsX(){return a(i(this,D))}set cellsX(e){g(i(this,D),l(e))}get cellsY(){return a(i(this,L))}set cellsY(e){g(i(this,L),l(e))}get name(){return a(i(this,E))}set name(e){g(i(this,E),l(e))}get id(){return a(i(this,k))}set id(e){g(i(this,k),l(e))}get isMoving(){return a(i(this,G))}set isMoving(e){g(i(this,G),l(e))}get selectedCellX(){return a(i(this,S))}set selectedCellX(e){g(i(this,S),l(e))}get selectedCellY(){return a(i(this,v))}set selectedCellY(e){g(i(this,v),l(e))}get selectedWidgetId(){return a(i(this,w))}set selectedWidgetId(e){g(i(this,w),l(e))}get selectedWidget(){return a(i(this,J))}get canPlace(){return a(i(this,T))}checkIndex(e){return this.coreCheckPlace(e%this.cellsX+1,Math.floor(e/this.cellsX)+1,this.selectedWidget)}coreCheckPlace(e,s,d){if(d==null)return!1;for(let o=0;o<d.sizes.x;o++)for(let r=0;r<d.sizes.y;r++){const u=e+o,y=s+r;if(u>this.cellsX||y>this.cellsY||u<1||y<1||this.modulesMap[y][u]!=null&&this.modulesMap[y][u]!=d.id)return!1}return!0}checkPlace(e){return this.coreCheckPlace(this.selectedCellX,this.selectedCellY,e)}getWidgetById(e){for(const s of this.modules)if(s.id==e)return s;return null}get modules(){return a(i(this,z))}set modules(e){g(i(this,z),l(e))}get modulesMap(){return a(i(this,W))}updateMap(e){let s=0,d=0;for(const r of e)s=Math.max(s,r.start.x+r.sizes.x),d=Math.max(d,r.start.y+r.sizes.y);const o=[];for(let r=1;r<this.cellsY+1;r++){o[r]=[];for(let u=1;u<this.cellsX+1;u++)o[r][u]=null}for(const r of e)for(let u=0;u<r.sizes.x;u++)for(let y=0;y<r.sizes.y;y++){const N=r.start.x+u,F=r.start.y+y;o[F][N]=r.id}return console.table(o),o}get countCells(){return a(i(this,$))}startMoving(e){this.isMoving=!0,this.selectedWidgetId=e;for(const s of this.modules)s.id==e&&(this.selectedCellX=s.start.x-1,this.selectedCellY=s.start.y-1)}stopMoving(e){e!=""&&e!=null&&K.add(e),this.isMoving=!1,this.selectedWidgetId=""}performMove(){if(this.selectedWidget!=null)for(const e of this.modules)e.id==this.selectedWidgetId&&(e.start.x=this.selectedCellX,e.start.y=this.selectedCellY)}canExpand(e,s,d){var N,F,q,Q;const{x:o,y:r}=e.start,{x:u,y}=e.sizes;if(s===1)for(let m=0;m<y;m++){const x=r+m,f=o+u;if(f>this.cellsX||((N=this.modulesMap[x])==null?void 0:N[f])!==null)return!1}else if(s===-1)for(let m=0;m<y;m++){const x=r+m,f=o-1;if(f<1||((F=this.modulesMap[x])==null?void 0:F[f])!==null)return!1}else if(d===1)for(let m=0;m<u;m++){const x=o+m,f=r+y;if(f>this.cellsY||((q=this.modulesMap[f])==null?void 0:q[x])!==null)return!1}else if(d===-1)for(let m=0;m<u;m++){const x=o+m,f=r-1;if(f<1||((Q=this.modulesMap[f])==null?void 0:Q[x])!==null)return!1}return!0}remove(e){this.modules=this.modules.filter(s=>s.id!=e)}addNew(e,s){if(this.modulesMap[s][e]!=null){K.add("Slot is already in use.");return}this.modules.push({id:p(),type:"Test",start:{x:e,y:s},sizes:{x:1,y:1}})}canExpandRight(e){return this.canExpand(e,1,0)}canExpandLeft(e){return this.canExpand(e,-1,0)}canExpandDown(e){return this.canExpand(e,0,1)}canExpandUp(e){return this.canExpand(e,0,-1)}static fromJSON(e){return new _(e)}toJSON(){return{id:this.id,name:this.name,x:this.cellsX,y:this.cellsY,modules:this.modules}}};D=new WeakMap,L=new WeakMap,E=new WeakMap,k=new WeakMap,G=new WeakMap,S=new WeakMap,v=new WeakMap,w=new WeakMap,J=new WeakMap,T=new WeakMap,z=new WeakMap,W=new WeakMap,$=new WeakMap;let C=_;function A(t,e,s=31536e3){document.cookie=`${t}=${e}; path=/; max-age=${s}`}function I(t){const e=document.cookie.match(new RegExp(`(?:^|; )${t.replace(/([.$?*|{}()[]\/+^])/g,"\\$1")}=([^;]*)`));return e?decodeURIComponent(e[1]):null}function oe(t){document.cookie=`${t}=; path=/; max-age=0`}var b,O,P,X,Y,U,R,B,H,V;class he{constructor(){n(this,b,c(I("theme")==="dark"));n(this,O,c(l(I("animations")||"fast")));n(this,P,c(l(I("primary")||"blue")));n(this,X,c(l(!!I("presets"))));n(this,Y,c("default"));n(this,U,c(l(this.getInitialGrids())));n(this,R,c(l(this.getInitialGrids())));n(this,B,M(()=>JSON.stringify(this.initialGrids)!=JSON.stringify(this.gridManagers)));n(this,H,M(()=>{const e=this.getGridById(this.selectedManagerID);return e??(this.selectedManagerID=this.gridManagers[0].id,this.gridManagers[0])}));n(this,V,M(()=>this.gridManagers.map(e=>e.id)));document.body.classList.toggle("dark-mode",this.isDark),document.body.classList.add(this.animationSpeed)}get isDark(){return a(i(this,b))}set isDark(e){g(i(this,b),l(e))}get animationSpeed(){return a(i(this,O))}set animationSpeed(e){g(i(this,O),l(e))}get primaryColor(){return a(i(this,P))}set primaryColor(e){g(i(this,P),l(e))}toggleIsDark(){this.isDark=!this.isDark,document.body.classList.toggle("dark-mode",this.isDark),A("theme",this.isDark?"dark":"light")}setSpeed(e){document.body.classList.remove(this.animationSpeed),this.animationSpeed=e,document.body.classList.add(this.animationSpeed),A("animations",e)}setPrimaryColor(e){document.body.classList.remove(this.primaryColor),this.primaryColor=e,document.body.classList.add(this.primaryColor),A("primary",this.primaryColor)}getInitialGrids(){const e=I("presets"),s=e?JSON.parse(e):[null],d=[];for(const[o,r]of Object.entries(s))d.push(C.fromJSON(r));return d.length<1?[new C(null)]:d}resetPresets(){this.selectedManagerID="default",oe("presets"),this.gridManagers=[new C(null)],this.initialGrids=[new C(null)],this.hasPresets=!1,se.showEdit=!1}removePreset(e){if(this.gridManagers.length==1){K.add("Cannot remove last preset.");return}this.gridManagers=this.gridManagers.filter(s=>s.id!=e)}get hasPresets(){return a(i(this,X))}set hasPresets(e){g(i(this,X),l(e))}get selectedManagerID(){return a(i(this,Y))}set selectedManagerID(e){g(i(this,Y),l(e))}get initialGrids(){return a(i(this,U))}set initialGrids(e){g(i(this,U),l(e))}get gridManagers(){return a(i(this,R))}set gridManagers(e){g(i(this,R),l(e))}get isGridEdited(){return a(i(this,B))}getGridById(e){for(const s of this.gridManagers)if(s.id==e)return s;return null}get currentGrid(){return a(i(this,H))}savePresets(){const e=this.gridManagers.map(s=>s.toJSON());A("presets",JSON.stringify(e)),this.hasPresets=!0,this.initialGrids=this.gridManagers}get allIDs(){return a(i(this,V))}}b=new WeakMap,O=new WeakMap,P=new WeakMap,X=new WeakMap,Y=new WeakMap,U=new WeakMap,R=new WeakMap,B=new WeakMap,H=new WeakMap,V=new WeakMap;const fe=new he;export{C as G,le as W,ye as a,de as d,fe as s};
